SELECT
    CAST(resultid AS integer) AS result_id,
    CAST(raceid AS integer) AS race_id,
    CAST(driverid AS integer) AS driver_id,
    CAST(constructorid AS integer) AS constructor_id,
    CAST(NULLIF(number, '\N') AS integer) AS car_number,
    CAST(grid AS integer) AS grid_position,
    CAST(NULLIF(position, '\N') AS integer) AS finish_position,
    CAST(positiontext AS varchar) AS finish_position_text,
    CAST(positionorder AS integer) AS finish_position_order,
    CAST(points AS double) AS points,
    CAST(laps AS integer) AS laps_completed,
    CAST(NULLIF(time, '\N') AS varchar) AS race_time_text,
    CAST(NULLIF(milliseconds, '\N') AS bigint) AS race_time_ms,
    CAST(NULLIF(fastestlap, '\N') AS integer) AS fastest_lap_number,
    CAST(NULLIF(rank, '\N') AS integer) AS fastest_lap_rank,
    CAST(NULLIF(fastestlaptime, '\N') AS varchar) AS fastest_lap_time_text,
    CAST(NULLIF(fastestlapspeed, '\N') AS double) AS fastest_lap_speed,
    CAST(statusid AS integer) AS status_id
FROM {{ source('f1', 'results') }}
